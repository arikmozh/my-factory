{"ast":null,"code":"var _jsxFileName = \"/Users/arikmoz/Desktop/Bootcamp/Projects/my-factory-v1/src/Pages/EditEmployeePage.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { useNavigate } from \"react-router-dom\";\nimport employeesUtils from \"../Utils/employeesUtils\";\nimport { Link } from \"react-router-dom\";\nimport axios from \"axios\";\nimport { Typography, Grid, TextField, Container, Button } from \"@mui/material\";\nimport { typography } from \"@mui/system\";\nimport EditEmployeeShiftTable from \"../Components/EditEmployeeShiftTable\";\nimport EditEmployeeSelect from \"../Components/EditEmployeeSelect\";\nimport { useSelector } from \"react-redux\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst EditEmployeePage = () => {\n  _s();\n\n  let token = sessionStorage[\"token\"];\n  const storeData = useSelector(state => state);\n  const navigate = useNavigate();\n  const params = useParams();\n  const [employee, setEmployee] = useState({});\n  const [updated, setUpdated] = useState(false);\n  const [AllShifts, setAllShifts] = useState({});\n  const [allocateBTN, setAllocateBTN] = useState(false);\n  const [SelectedShiftToAdd, setSelectedShiftToAdd] = useState(\"\");\n  const [AllocateOptions, setAllocateOptions] = useState([]);\n  const [shift_id, setShift_id] = useState(\"\");\n  useEffect(async () => {\n    let all_db_data = storeData.db;\n    let employee = all_db_data.employees[params.id];\n    setEmployee(employee);\n    setAllShifts(all_db_data.shifts);\n    let Emp_Shift_ids;\n    let options = [];\n\n    if (all_db_data !== null && all_db_data !== void 0 && all_db_data.employees[params.id].hasOwnProperty(\"Shifts\")) {\n      Emp_Shift_ids = all_db_data.employees[params.id].Shifts.map(s => s._id);\n\n      for (let i = 0; i < all_db_data.shifts.length; i++) {\n        if (!Emp_Shift_ids.includes(all_db_data.shifts[i]._id)) {\n          options.push(all_db_data.shifts[i]);\n        }\n      }\n    } else {\n      options = all_db_data.shifts;\n    }\n\n    setAllocateOptions(options);\n  }, []);\n  useEffect(async () => {\n    let resp = await axios.get(\"http://127.0.0.1:5000/getAllFactory\");\n    let all_db_data = resp.data;\n    let employee = all_db_data.employees[params.id];\n    setEmployee(employee);\n    setAllShifts(all_db_data.shifts);\n    let Emp_Shift_ids;\n    let options = [];\n\n    if (all_db_data.employees[params.id].hasOwnProperty(\"Shifts\")) {\n      Emp_Shift_ids = all_db_data.employees[params.id].Shifts.map(s => s._id);\n\n      for (let i = 0; i < all_db_data.shifts.length; i++) {\n        if (!Emp_Shift_ids.includes(all_db_data.shifts[i]._id)) {\n          options.push(all_db_data.shifts[i]);\n        }\n      }\n    } else {\n      options = all_db_data.shifts;\n    } // return options;\n\n\n    setAllocateOptions(options);\n  }, [allocateBTN]);\n\n  const UpdateUserData = async () => {\n    console.log(employee);\n    await employeesUtils.update_employee(token, employee._id, employee);\n    setUpdated(!updated);\n  };\n\n  const DeleteUserData = async () => {\n    await employeesUtils.delete_employee(token, employee._id);\n    navigate(\"/mainPage/employeePage\");\n  };\n\n  const alocate_shift_to_emp = async () => {\n    await employeesUtils.add_shift_to_employee(token, employee._id, shift_id);\n    setAllocateBTN(!allocateBTN);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: /*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"h4\",\n      style: {\n        marginTop: \"35px\",\n        marginBottom: \"35px\"\n      },\n      children: /*#__PURE__*/_jsxDEV(\"b\", {\n        children: \" Edit Employee - Page\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 5\n  }, this);\n};\n\n_s(EditEmployeePage, \"qTCGWRJ8JLitidlYaG71butcHmE=\", false, function () {\n  return [useSelector, useNavigate, useParams];\n});\n\n_c = EditEmployeePage;\nexport default EditEmployeePage;\n\nvar _c;\n\n$RefreshReg$(_c, \"EditEmployeePage\");","map":{"version":3,"sources":["/Users/arikmoz/Desktop/Bootcamp/Projects/my-factory-v1/src/Pages/EditEmployeePage.js"],"names":["useState","useEffect","useParams","useNavigate","employeesUtils","Link","axios","Typography","Grid","TextField","Container","Button","typography","EditEmployeeShiftTable","EditEmployeeSelect","useSelector","EditEmployeePage","token","sessionStorage","storeData","state","navigate","params","employee","setEmployee","updated","setUpdated","AllShifts","setAllShifts","allocateBTN","setAllocateBTN","SelectedShiftToAdd","setSelectedShiftToAdd","AllocateOptions","setAllocateOptions","shift_id","setShift_id","all_db_data","db","employees","id","shifts","Emp_Shift_ids","options","hasOwnProperty","Shifts","map","s","_id","i","length","includes","push","resp","get","data","UpdateUserData","console","log","update_employee","DeleteUserData","delete_employee","alocate_shift_to_emp","add_shift_to_employee","marginTop","marginBottom"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { useNavigate } from \"react-router-dom\";\nimport employeesUtils from \"../Utils/employeesUtils\";\nimport { Link } from \"react-router-dom\";\nimport axios from \"axios\";\nimport { Typography, Grid, TextField, Container, Button } from \"@mui/material\";\nimport { typography } from \"@mui/system\";\nimport EditEmployeeShiftTable from \"../Components/EditEmployeeShiftTable\";\nimport EditEmployeeSelect from \"../Components/EditEmployeeSelect\";\nimport { useSelector } from \"react-redux\";\nconst EditEmployeePage = () => {\n  let token = sessionStorage[\"token\"];\n  const storeData = useSelector((state) => state);\n  const navigate = useNavigate();\n  const params = useParams();\n  const [employee, setEmployee] = useState({});\n  const [updated, setUpdated] = useState(false);\n  const [AllShifts, setAllShifts] = useState({});\n  const [allocateBTN, setAllocateBTN] = useState(false);\n  const [SelectedShiftToAdd, setSelectedShiftToAdd] = useState(\"\");\n  const [AllocateOptions, setAllocateOptions] = useState([]);\n  const [shift_id, setShift_id] = useState(\"\");\n\n  useEffect(async () => {\n    let all_db_data = storeData.db;\n    let employee = all_db_data.employees[params.id];\n    setEmployee(employee);\n    setAllShifts(all_db_data.shifts);\n\n    let Emp_Shift_ids;\n    let options = [];\n    if (all_db_data?.employees[params.id].hasOwnProperty(\"Shifts\")) {\n      Emp_Shift_ids = all_db_data.employees[params.id].Shifts.map((s) => s._id);\n\n      for (let i = 0; i < all_db_data.shifts.length; i++) {\n        if (!Emp_Shift_ids.includes(all_db_data.shifts[i]._id)) {\n          options.push(all_db_data.shifts[i]);\n        }\n      }\n    } else {\n      options = all_db_data.shifts;\n    }\n    setAllocateOptions(options);\n  }, []);\n\n  useEffect(async () => {\n    let resp = await axios.get(\"http://127.0.0.1:5000/getAllFactory\");\n    let all_db_data = resp.data;\n    let employee = all_db_data.employees[params.id];\n    setEmployee(employee);\n    setAllShifts(all_db_data.shifts);\n\n    let Emp_Shift_ids;\n    let options = [];\n    if (all_db_data.employees[params.id].hasOwnProperty(\"Shifts\")) {\n      Emp_Shift_ids = all_db_data.employees[params.id].Shifts.map((s) => s._id);\n\n      for (let i = 0; i < all_db_data.shifts.length; i++) {\n        if (!Emp_Shift_ids.includes(all_db_data.shifts[i]._id)) {\n          options.push(all_db_data.shifts[i]);\n        }\n      }\n    } else {\n      options = all_db_data.shifts;\n    }\n    // return options;\n    setAllocateOptions(options);\n  }, [allocateBTN]);\n\n  const UpdateUserData = async () => {\n    console.log(employee);\n    await employeesUtils.update_employee(token, employee._id, employee);\n    setUpdated(!updated);\n  };\n\n  const DeleteUserData = async () => {\n    await employeesUtils.delete_employee(token, employee._id);\n    navigate(\"/mainPage/employeePage\");\n  };\n\n  const alocate_shift_to_emp = async () => {\n    await employeesUtils.add_shift_to_employee(token, employee._id, shift_id);\n    setAllocateBTN(!allocateBTN);\n  };\n\n  return (\n    <Container>\n      <Typography\n        variant=\"h4\"\n        style={{ marginTop: \"35px\", marginBottom: \"35px\" }}\n      >\n        <b> Edit Employee - Page</b>\n      </Typography>\n      {/* <Grid>\n        <form>\n          <Typography>First name:</Typography>\n          <TextField\n            varient=\"outlined\"\n            required\n            value={employee.FirstName}\n            onChange={(e) =>\n              setEmployee({ ...employee, FirstName: e.target.value })\n            }\n          />\n          <Typography>Last name:</Typography>\n          <TextField\n            varient=\"outlined\"\n            required\n            value={employee.LastName}\n            onChange={(e) =>\n              setEmployee({ ...employee, LastName: e.target.value })\n            }\n          />\n          <Typography>Start work year:</Typography>\n          <TextField\n            varient=\"outlined\"\n            required\n            value={employee.StartWorkYear}\n            onChange={(e) =>\n              setEmployee({ ...employee, StartWorkYear: e.target.value })\n            }\n          />\n          <Typography>Department: </Typography>\n          {employee.hasOwnProperty(\"DepartmentId\") &&\n            employee.DepartmentId.map((item, index) => {\n              return (\n                <Link\n                  to={\"/mainPage/editdepartmentPage/\" + item._id}\n                  style={{ color: \"black\", textDecoration: \"underline\" }}\n                  key={index}\n                >\n                  {item.Name}\n                </Link>\n              );\n            })}\n          <Typography>Shifts: </Typography>\n          <EditEmployeeShiftTable employee={employee} />\n          <Typography>Select shift to allocate:</Typography>\n          <EditEmployeeSelect\n            AllocateOptions={AllocateOptions}\n            setShift_id={setShift_id}\n          />\n        </form>\n        <Button\n          // type=\"submit\"\n          variant=\"contained\"\n          onClick={UpdateUserData}\n        >\n          UPDATE\n        </Button>\n        <Button\n          // type=\"submit\"\n          variant=\"contained\"\n          onClick={DeleteUserData}\n        >\n          DELETE\n        </Button>\n        <Button\n          // type=\"submit\"\n          variant=\"contained\"\n          onClick={alocate_shift_to_emp}\n        >\n          Allocate\n        </Button>\n        <br />\n        <br />\n        {allocateBTN && <text>Allocated!</text>}\n        {updated && <text>Updated!</text>} */}\n      {/* </Grid> */}\n    </Container>\n  );\n};\n\nexport default EditEmployeePage;\n"]},"metadata":{},"sourceType":"module"}